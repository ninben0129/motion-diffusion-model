
# LSTM一個だけ推論
python lstm_emotion_classify.py --mode infer \
  --ckpt checkpoints/best.pt \
  --input_npy data/test/JP_06_anger_2_H.npy

python lstm_emotion_classify.py --mode infer \
  --ckpt checkpoints/best.pt \
  --input_npy data/test/JP_06_fear_1_M.npy


python lstm_emotion_classify.py --mode train --data_root data --epochs 20 --batch_size 16

python lstm_emotion_classify.py \
  --mode train \
  --data_root data \
  --epochs 20 \
  --batch_size 16 \
  --ckpt_name lstm_uni120.pt \
  --log_file lstm_uni120_log.csv

python lstm_emotion_classify.py \
  --mode train \
  --data_root data \
  --epochs 100 \
  --batch_size 16 \
  --ckpt_name lstm_uni120.pt \
  --log_file lstm_uni120_log.csv \
  --early_stop_patience 7

 python lstm_emotion_classify.py \
  --mode train \
  --data_root data \
  --epochs 100 \
  --batch_size 16 \
  --ckpt_name bilstm_0909.pt \
  --log_file bilstm_0909.csv \
  --early_stop_patience 7 \
  --bidirectional

  python lstm_intensity_classify.py \
    --mode train \
    --data_root data \
    --epochs 100 \
    --batch_size 16 \
    --early_stop_patience 5 \
    --min_delta 1e-4

  python lstm_emotion_classify.py \
  --mode train \
  --data_root data_TW \
  --epochs 100 \
  --batch_size 16 \
  --bidirectional \
  --early_stop_patience 7 \
  --ckpt_dir checkpoints \
  --ckpt_name bilstm_TW.pt \
  --log_file bilstm_TW_log.csv

 python lstm_emotion_classify.py --mode train --data_root data_TW \
  --bidirectional --hidden_size 256 --dropout 0.3 \
  --ckpt_name bilstm_h256_do03.pt --log_file bilstm_h256_do03.csv

  python lstm_emotion_classify.py \
  --mode train \
  --data_root data_TW \
  --epochs 50 \
  --batch_size 16 \
  --bidirectional \
  --num_layers 2 \
  --hidden_size 256 \
  --dropout 0.3 \
  --early_stop_patience 5 \
  --ckpt_dir checkpoints \
  --ckpt_name bilstm2_h256_do03_ep50.pt \
  --log_file bilstm2_h256_do03_ep50.csv

python lstm_emotion_classify.py \
  --mode train \
  --data_root data_TW \
  --epochs 100 \
  --batch_size 16 \
  --bidirectional \
  --num_layers 2 \
  --hidden_size 512 \
  --dropout 0.5 \
  --early_stop_patience 8 \
  --ckpt_dir checkpoints \
  --ckpt_name bilstm2_h512_do05_ep100.pt \
  --log_file bilstm2_h512_do05_ep100.csv

python lstm_emotion_classify.py \
  --mode infer \
  --ckpt checkpoints/bilstm_TW.pt \
  --input_dir data/train \
  --save_csv preds_JP.csv


python lstm_emotion_classify_tail.py --mode train --data_root data_TW \
      --epochs 100 --batch_size 16 --bidirectional --num_layers 2 \
      --hidden_size 256 --dropout 0.3 \
      --early_stop_patience 8 \
      --tail_crop --tail_min_ratio 0.3 --train_crop_len 800 --tail_mix_prob 0.5 \
      --ckpt_dir checkpoints --ckpt_name bilstm2_h256_tail03_w800_mix05.pt \
      --log_file bilstm2_h256_tail03_w800_mix05.csv


python lstm_emotion_classify.py \
  --mode infer \
  --ckpt checkpoints/bilstm2_h256_tail03_w800_mix05.pt \
  --input_dir data/train \
  --save_csv preds_JP_tail.csv

python lstm_emotion_classify_basic7.py --mode train --data_root data_TW \
      --epochs 60 --batch_size 16 --bidirectional --num_layers 2 \
      --hidden_size 256 --dropout 0.3 \
      --center_crop --crop_ratio 0.6 --center_low 0.3 --center_high 0.7 --center_mix_prob 0.5 \
      --ckpt_dir checkpoints --ckpt_name bilstm2_h256_center06_mix05_basic7.pt \
      --log_file bilstm2_h256_center06_mix05_basic7.csv

python lstm_emotion_classify_basic7.py --mode train --data_root data_TW \
  --epochs 80 --batch_size 16 --bidirectional --num_layers 2 \
  --hidden_size 384 --dropout 0.3 \
  --center_crop --crop_ratio 0.7 --center_low 0.3 --center_high 0.65 --center_mix_prob 0.7 \
  --lr 8e-4 --weight_decay 2e-4 --lr_patience 3 \
  --early_stop_patience 8 --min_delta 5e-4 \
  --ckpt_dir checkpoints --ckpt_name bilstm2_h384_center07_mix07.pt \
  --log_file bilstm2_h384_center07_mix07.csv

python lstm_emotion_classify_basic7.py \
  --mode infer \
  --ckpt checkpoints/bilstm2_h384_center07_mix07.pt \
  --input_dir data/train \
  --save_csv preds_JP_basic7_1208.csv

python lstm_emotion_classify_basic7.py \
  --mode infer \
  --ckpt checkpoints/bilstm2_h384_center07_mix07.pt \
  --input_dir output_pretrained \
  --save_csv preds_pretrained.csv

python lstm_emotion_classify_basic7.py \
  --mode infer \
  --ckpt checkpoints/bilstm2_h384_center07_mix07.pt \
  --input_dir output_finetuned \
  --save_csv preds_finetuned.csv

python lstm_emotion_classify_basic7.py \
  --mode infer \
  --ckpt checkpoints/bilstm2_h384_center07_mix07.pt \
  --input_dir groundtruth_test \
  --save_csv preds_groundtruth.csv

python -m sample.generate263D_1006 \
  --model_path ./save/finetune_0524_person/model000200000.pt \
  --num_repetitions 1 \
  --output_dir ./classifier/output_finetuned \
  --name_list ./dataset/HumanML3D/test.txt \
  --prompt_dir ./dataset/new_joint_vecs
